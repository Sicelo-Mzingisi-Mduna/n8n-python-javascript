[supervisord]
nodaemon=true
user=root
logfile=/dev/stdout
logfile_maxbytes=0

# -------------------------------
# Main n8n server
# -------------------------------
[program:n8n-main]
command=n8n start
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
environment=N8N_TASK_RUNNERS_FILE="/home/node/.n8n/n8n-task-runners.json",NODE_ENV="production"

# -------------------------------
# n8n Python Task Runner
# -------------------------------
[program:n8n-python-runner]
command=/usr/local/bin/task-runner-launcher --config /home/node/.n8n/n8n-task-runners.json
autostart=true
autorestart=true
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr

# -------------------------------
# DEBUG PROGRAMS
# -------------------------------

[program:debug-ls]
command=ls -la /home/node/.n8n
autostart=true
startsecs=0
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:debug-cat-task-runners]
command=cat /home/node/.n8n/n8n-task-runners.json
autostart=true
startsecs=0
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:debug-env]
command=env
autostart=true
startsecs=0
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:debug-task-runner-launcher-version]
command=/usr/local/bin/task-runner-launcher --version
autostart=true
startsecs=0
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
